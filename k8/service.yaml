apiVersion: apps/v1
kind: Deployment
metadata:
name: tasks
spec:
selector:
    matchLabels:
    app: tasks
replicas: 1
template:
    metadata:
    labels:
        app: tasks
    spec:
    containers:
        - name: tasks
        image: humbertosandmann/tasks:latest
        ports:
            - containerPort: 8080
        env:
            - name: DATABASE_HOST
            valueFrom:
                configMapKeyRef:
                name: postgres-configmap
                key: POSTGRES_HOST
            - name: DATABASE_DB
            valueFrom:
                configMapKeyRef:
                name: postgres-configmap
                key: POSTGRES_DB
            - name: DATABASE_USERNAME
            valueFrom:
                secretKeyRef:
                name: postgres-credentials
                key: POSTGRES_USERNAME
            - name: DATABASE_PASSWORD
            valueFrom:
                secretKeyRef:
                name: postgres-credentials
                key: POSTGRES_PASSWORD